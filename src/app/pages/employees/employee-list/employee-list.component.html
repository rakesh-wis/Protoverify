<div class="container-fluid page-padding">
	<div class="row justify-content-between align-items-center">
		<div class="col-lg-3 col-md-4 col-sm-12">
			<h2 class="text-primary fs-3 fw-bold">Employees</h2>
		</div>
		<div class="col-lg-3 col-md-4 col-sm-12 text-end">
			<button type="button" class="btn btn-primary w-100" *ngIf="!isRoleAccess" (click)="add()">
				Add an employee
			</button>
		</div>
	</div>
	<div class="row">
		<div class="col-lg-3 col-md-4 col-sm-12">
			<div class="input-group flex-nowrap">
				<span class="input-group-text bg-transparent search-input-group" id="addon-wrapping">
					<mat-icon mat-list-icon>search</mat-icon>
				</span>
				<input
					type="text"
					class="form-control search-form-control bg-transparent"
					placeholder="Search"
					aria-label="search"
					[ngModelOptions]="{ standalone: true }"
					[(ngModel)]="searchTerm"
					(keyup)="applyFilters()"
				/>
			</div>
		</div>
		<div class="col-lg-3 col-md-4 col-sm-12">
			<div class="form-group">
				<select
					class="form-select bg-transparent text-capitalize"
					aria-label="select example"
					[(ngModel)]="statusFilter"
					(change)="applyFilters()"
				>
					<option [value]="item.name" *ngFor="let item of statusList">
						<span>{{ item.label }}</span>
					</option>
				</select>
			</div>
		</div>
	</div>

	<ng-container>
		<div class="table-responsive mt-3">
			<table class="table table-hover">
				<thead>
					<tr>
						<th scope="col" sortable="profileIdentifier">Emp ID</th>
						<th scope="col" sortable="name" (sort)="onSort($event)">Name</th>
						<th scope="col" sortable="mobileNumber" (sort)="onSort($event)">Number</th>
						<th scope="col" sortable="email" (sort)="onSort($event)">Email</th>
						<th scope="col">Designation</th>
						<th scope="col" *ngIf="isRoleAccess" class="text-nowrap">Organization</th>
						<th scope="col">Role</th>
						<th scope="col">Platform</th>
						<th scope="col" class="text-nowrap">Verification Status</th>
						<th scope="col">Status</th>
						<th scope="col">Action</th>
					</tr>
				</thead>
				<tbody *ngIf="dataList['count'] > 0">
					<tr *ngFor="let item of dataList?.rows">
						<td class="text-capitalize text-wrap">
							{{ item?.profileIdentifier | truncate }}
						</td>
						<td class="text-capitalize text-wrap">
							{{ item.name || '-' | truncate }}
						</td>
						<td class="text-wrap">{{ item?.mobileNumber | truncate }}</td>
						<td class="text-wrap">{{ item?.email || '-' | truncate }}</td>
						<td class="text-wrap">{{ item?.designation || '-' | truncate }}</td>
						<td class="text-wrap" *ngIf="isRoleAccess">
							{{ item?.associated?.businessDetails?.registeredName || item?.associated?.name | truncate }}
						</td>
						<td class="text-nowrap">{{ getRole(item?.role) | truncate }}</td>
						<td class="text-nowrap text-capitalize">{{ item?.registrationPlatform | truncate }}</td>
						<td class="text-wrap">
							<button class="btn badge-{{ item?.verificationStatus }} text-capitalize">
								{{ customStatus(item?.verificationStatus) }}
							</button>
						</td>
						<td class="text-wrap">
							<button class="btn badge-{{ item?.status }} text-capitalize">
								{{ customStatus(item?.status) }}
							</button>
						</td>
						<td>
							<div ngbDropdown container="body">
								<span type="button" ngbDropdownToggle>
									<mat-icon>more_vert</mat-icon>
								</span>
								<div ngbDropdownMenu>
									<button ngbDropdownItem class="btn" (click)="manage(item)" *appIsGranted="'VIEW'">
										View Details
									</button>
									<button ngbDropdownItem class="btn" (click)="edit(item)" *appIsGranted="'EDIT'">
										Edit
									</button>
									<button
										ngbDropdownItem
										class="btn"
										(click)="changeOrganization(item)"
										*ngIf="adminRoles.includes(currentUser.role)"
									>
										Change Organization
									</button>
									<button
										ngbDropdownItem
										class="btn text-capitalize"
										*ngIf="![defaultStatus.ON_BOARDED, defaultStatus.PENDING].includes(item)"
										(click)="changeStatus(item)"
									>
										Change Status
									</button>
									<button
										ngbDropdownItem
										class="btn"
										(click)="viewTemplate(item)"
										*ngIf="!isRoleAccess"
									>
										View offer letter
									</button>
									<button
										ngbDropdownItem
										class="btn text-danger"
										(click)="openConfirmDelete(item)"
										*appIsGranted="'DELETE'"
									>
										Delete
									</button>
								</div>
							</div>
						</td>
					</tr>
				</tbody>
				<tbody *ngIf="dataList['count'] === 0">
					<tr>
						<td class="text-center" [attr.colspan]="6">{{ OPTIONS?.noRecord }}</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="d-flex justify-content-center align-items-start w-100 p-3" *ngIf="dataList['count'] > 0">
			<ng-container>
				<div
					class="d-flex align-items-center previous-next-items text-primary"
					role="button"
					(click)="onPageChange(page - 1, 'prev')"
					[ngClass]="{ 'text-primary-100': isPrevious() }"
				>
					<mat-icon mat-list-icon>arrow_back</mat-icon>
					<span class="ps-1">Previous</span>
				</div>
			</ng-container>
			<ngb-pagination
				[collectionSize]="collectionSize"
				[(page)]="page"
				[pageSize]="pageSize"
				(pageChange)="onPageChange($event, null)"
				[maxSize]="5"
				[directionLinks]="false"
			>
			</ngb-pagination>
			<ng-container>
				<div
					class="d-flex align-items-center previous-next-items text-primary"
					role="button"
					(click)="onPageChange(page + 1, 'next')"
					[ngClass]="{ 'text-primary-100': isLastPage() }"
				>
					<span class="pe-1">Next</span>
					<mat-icon mat-list-icon>arrow_forward</mat-icon>
				</div>
			</ng-container>
		</div>
	</ng-container>
</div>
